<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Username List Upload</title>
  <link href="https://hckrxyzz.github.io/Xyzz/MyStyle.css" rel="stylesheet" />
  <link href="https://hckrxyzz.github.io/Xyzz/pattern.css" rel="stylesheet">
  <script src="https://apis.google.com/js/api.js"></script>
</head>

<body>
  <header class="bg-pattern1">
    <h2>hckrXyzz</h2>
  </header>
  <div class="content">
    <button class="crimson" type="button" id="authorize_button">Authorize</button>
    <button class="crimson" type="button" id="signout_button">Sign Out</button>
    <div id="responseContainer"></div>
  </div>

  <footer>
    @footer
  </footer>

  <script>
    var CLIENT_ID = '953384927834-lpkr6me58b70p8cv0nccp6mv4featggt.apps.googleusercontent.com';
    var API_KEY = 'AIzaSyBpaHXFrurTVaUeOGczuGPinhtvv7PqhbQ';
    var DISCOVERY_DOCS = ["https://docs.googleapis.com/$discovery/rest?version=v1"];
    var SCOPES = "https://www.googleapis.com/auth/documents";

    var authorizeButton = document.getElementById('authorize_button');
    var signoutButton = document.getElementById('signout_button');
    var responseContainer = document.getElementById('responseContainer');

    function handleClientLoad() {
      gapi.load('client:auth2', initClient);
    }

    function initClient() {
      gapi.client.init({
        apiKey: API_KEY,
        clientId: CLIENT_ID,
        discoveryDocs: DISCOVERY_DOCS,
        scope: SCOPES
      }).then(function () {
        gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus);
        updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get());
        authorizeButton.onclick = handleAuthClick;
        signoutButton.onclick = handleSignoutClick;
      }, function (error) {
        console.error(JSON.stringify(error, null, 2));
      });
    }

    function updateSigninStatus(isSignedIn) {
      if (isSignedIn) {
        authorizeButton.style.display = 'none';
        signoutButton.style.display = 'block';
        postTextToGoogleDoc();
      } else {
        authorizeButton.style.display = 'block';
        signoutButton.style.display = 'none';
      }
    }

    function handleAuthClick(event) {
      gapi.auth2.getAuthInstance().signIn();
    }

    function handleSignoutClick(event) {
      gapi.auth2.getAuthInstance().signOut();
    }

    function postTextToGoogleDoc() {
      var docId = '1JrgsKwexHeYBn7OdejHk_nx9r5Vith_UHbt51Jb7i4Q';
      var requests = [
        {
          insertText: {
            location: {
              index: 1,
            },
            text: 'Hello, world!'
          }
        }
      ];

      gapi.client.docs.documents.batchUpdate({
        documentId: docId,
        requests: requests
      }).then((response) => {
        console.log('Text posted successfully:', response);
        responseContainer.innerHTML = 'Text posted successfully: ' + JSON.stringify(response, null, 2);
      }, (error) => {
        console.error('Error posting text:', error);
        responseContainer.innerHTML = 'Error posting text: ' + JSON.stringify(error, null, 2);
      });
    }
    
    handleClientLoad();

  </script>
</body>

</html>
